name: publish site
on:
  push:
    branches:
      - static-site
jobs:
    #prepare:
    #  runs-on: ubuntu-latest
    #  steps:
    #    - name: checkout
    #      uses: actions/checkout@v4
    #    - name: test1
    #      run: ls
    #    - name: test2
    #      run: pwd
    build-site:
      runs-on: ubuntu-latest
      container: clojure:lein
      permissions:
        pages: write
        id-token: write
      steps:
        - name: checkout
          uses: actions/checkout@v4
        - name: build
          run: lein build-site
        - name: upload
          uses: actions/upload-pages-artifact@v3
          with:
            path: "target/site"
        - name: deploy
          uses: actions/deploy-pages@v4
        - name: test
          run: echo ${{steps.deployment.outputs.page_url}}